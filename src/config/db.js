// config/db.js

// !!! –í–ê–ñ–ù–û: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ dotenv –ù–ï –ó–ê–ì–†–£–ñ–ê–ï–¢–°–Ø –∑–¥–µ—Å—å. –û–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ bot.js.
// require('dotenv').config({ path: __dirname + '/../primer.env' }); // <-- –≠–¢–£ –°–¢–†–û–ö–£ –£–î–ê–õ–ò–¢–¨, –µ—Å–ª–∏ –æ–Ω–∞ –±—ã–ª–∞!

const mongoose = require('mongoose');

const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGODB_URI, {
      socketTimeoutMS: 30000,
      connectTimeoutMS: 10000,
      serverSelectionTimeoutMS: 5000,
      heartbeatFrequencyMS: 10000
    });
    console.log('‚úÖ MongoDB connected');
  } catch (err) {
    console.error('‚ùå MongoDB connection error:', err);
    // –í–∞–∂–Ω–æ: –∑–¥–µ—Å—å –º—ã –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É, —á—Ç–æ–±—ã –≤—ã–∑—ã–≤–∞—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–≤ bot.js)
    // –º–æ–≥–ª–∞ –µ–µ –ø–æ–π–º–∞—Ç—å –∏ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–π—Ç–∏ –∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞).
    // –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∏–∑–≤–Ω–µ, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
    // —á–µ—Ä–µ–∑ –ª–æ–≥–∏–∫—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ PM2 –∏–ª–∏ –¥—Ä—É–≥—É—é —Å–∏—Å—Ç–µ–º—É –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏.
    throw err;
  }
};

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–æ—Å—Ç–∞–≤—å—Ç–µ –∏—Ö)
// –≠—Ç–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±—É–¥—É—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è MongoDB
// –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
mongoose.connection.on('disconnected', () => {
  console.log('‚ö†Ô∏è MongoDB disconnected');
});

mongoose.connection.on('reconnected', () => {
  console.log('üîÅ MongoDB reconnected');
});

module.exports = connectDB;